{% extends "base.html" %}

{% block title %}Current Data{% endblock %}

{% block content %}
<section>

    <h1>Current Data</h1>
    <button id="fetchButton" onclick="fetchData()">Fetch Data</button>
    <pre id="result"></pre>
    <script>
      function fetchData() {
        var button = document.getElementById("fetchButton");

        // Disable button immediately
        button.disabled = true; 

        fetch('/api/current_data')
          .then(response => response.json())
          .then(data => {
            // Pretty-print the JSON data
            document.getElementById("result").textContent = JSON.stringify(data, null, 2);
          })
          .catch(error => {
            document.getElementById("result").textContent = "Error fetching data.";
          });
          
        // Re-enable the button after 5 minutes (300000 milliseconds)
        setTimeout(function() {
          button.disabled = false;
        }, 300000);
      }
    </script>

</section>
{% endblock %}
